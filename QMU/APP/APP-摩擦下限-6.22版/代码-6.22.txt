classdef QMU_main < matlab.apps.AppBase

    % Properties that correspond to app components
    properties (Access = public)
        UIFigure             matlab.ui.Figure
        Label                matlab.ui.control.Label
        Panel                matlab.ui.container.Panel
        Label_4              matlab.ui.control.Label
        Label_5              matlab.ui.control.Label
        REditField           matlab.ui.control.EditField
        mKnobLabel           matlab.ui.control.Label
        RKnob                matlab.ui.control.Knob
        cmLabel              matlab.ui.control.Label
        HKnob                matlab.ui.control.Knob
        MPaKnobLabel         matlab.ui.control.Label
        MPaKnob              matlab.ui.control.Knob
        ThetaKnobLabel       matlab.ui.control.Label
        ThetaKnob            matlab.ui.control.Knob
        mKnob_2Label         matlab.ui.control.Label
        R2Knob               matlab.ui.control.Knob
        HEditField           matlab.ui.control.EditField
        R2EditField          matlab.ui.control.EditField
        ThetaEditField       matlab.ui.control.EditField
        MPaEditField         matlab.ui.control.EditField
        MLPredictButton      matlab.ui.control.Button
        ZJLamp               matlab.ui.control.Lamp
        MCLamp               matlab.ui.control.Lamp
        Label_6              matlab.ui.control.Label
        ZJEditField          matlab.ui.control.EditField
        Label_7              matlab.ui.control.Label
        MCEditField          matlab.ui.control.EditField
        QMUPanel             matlab.ui.container.Panel
        ZJButton             matlab.ui.control.Button
        ZJUITable            matlab.ui.control.Table
        MCFilePathEditField  matlab.ui.control.EditField
        MCUITable            matlab.ui.control.Table
        MCButton             matlab.ui.control.Button
        FilePathLabel        matlab.ui.control.Label
        ZJFilePathEditField  matlab.ui.control.EditField
        MEditFieldLabel      matlab.ui.control.Label
        MEditField           matlab.ui.control.EditField
        Label_16             matlab.ui.control.Label
        MCbetweenEditField   matlab.ui.control.EditField
        Label_18             matlab.ui.control.Label
        P0EditField          matlab.ui.control.EditField
        bEditField_2Label    matlab.ui.control.Label
        bEditField           matlab.ui.control.EditField
        Label_19             matlab.ui.control.Label
        rouEditField         matlab.ui.control.EditField
        GEditField_2Label    matlab.ui.control.Label
        GEditField           matlab.ui.control.EditField
        HEditField_2Label    matlab.ui.control.Label
        H2EditField          matlab.ui.control.EditField
        Label_20             matlab.ui.control.Label
        UpEditField          matlab.ui.control.EditField
        Label_22             matlab.ui.control.Label
        MCalphaEditField     matlab.ui.control.EditField
        X0Label              matlab.ui.control.Label
        X0EditField          matlab.ui.control.EditField
        XthEditFieldLabel    matlab.ui.control.Label
        XthEditField         matlab.ui.control.EditField
        MLabel               matlab.ui.control.Label
        ZJMEditField         matlab.ui.control.EditField
        QLabel               matlab.ui.control.Label
        ZJQEditField         matlab.ui.control.EditField
        UEditFieldLabel      matlab.ui.control.Label
        ZJUEditField         matlab.ui.control.EditField
        Label_12             matlab.ui.control.Label
        X0Label_2            matlab.ui.control.Label
        MClimEditField       matlab.ui.control.EditField
        XthEditField_2Label  matlab.ui.control.Label
        Xth2EditField        matlab.ui.control.EditField
        MLabel_2             matlab.ui.control.Label
        MCMEditField         matlab.ui.control.EditField
        ULabel_2             matlab.ui.control.Label
        MCUEditField         matlab.ui.control.EditField
        QLabel_2             matlab.ui.control.Label
        MCQEditField         matlab.ui.control.EditField
        Label_11             matlab.ui.control.Label
        QMUButton            matlab.ui.control.Button
        reportButton         matlab.ui.control.Button
        QLabel_3             matlab.ui.control.Label
        MixQEditField        matlab.ui.control.EditField
        MLabel_3             matlab.ui.control.Label
        MixMEditField        matlab.ui.control.EditField
        ULabel_3             matlab.ui.control.Label
        MixUEditField        matlab.ui.control.EditField
        QMULabel_5           matlab.ui.control.Label
        ZJGauge              matlab.ui.control.Gauge
        ZJQLamp              matlab.ui.control.Lamp
        MCGauge              matlab.ui.control.Gauge
        MCQLamp              matlab.ui.control.Lamp
        Label_23             matlab.ui.control.Label
        DropDown             matlab.ui.control.DropDown
        UIAxes               matlab.ui.control.UIAxes
        UIZJAxes             matlab.ui.control.UIAxes
        UIMCAxes             matlab.ui.control.UIAxes
        Button               matlab.ui.control.Button
    end

    
    properties (Access = private)
        
        % 全局属性存放于此
        
%         % 机器学习预测生成结果
%         zj_predict;
%         mc_predict;
%         mix_predict;
        
%         mc_th;
        
        % QMU评估
        xls_dir;
        xls_dir2;
        
        data_example;
        Ni_Stimulus_Xi;
        Stimulus_Xi;
        stage_mitrix_i;
        nABMb;
        parameter_n;
        parameter_A;
        parameter_B;
        parameter_M;
        parameter_little_b;
        parameter_rou;
        
        mc_data;
        data_col;
        data_example2_matrix;
        zhixindu;
        explore_num;
        mc_prob;
        mc_Z;
        f_a;
        f_b;
        f_c;
        f_delta;
        mc_plow;
        mc_phigh;
        mc_between;
        
        % 生成结果
        ZJ_M;
        ZJ_U;
        ZJ_Q;
        MC_M;
        MC_U;
        MC_Q;
        
        mixQ;
        
    end
    

    % Callbacks that handle component events
    methods (Access = private)

        % Button pushed function: MLPredictButton
        function MLPredictButtonPushed(app, event)
            % 机器学习预测
           % 按下预测按钮             
           
            % 撞击数据预测
%             load zj_model.mat;

%             load zj_model_new.mat; % 3.11新模型
            exampleObject = matfile('zj_model_new.mat');
            zjmodel= exampleObject.trainedModel;
%             varlist = who(exampleObject);

%             zj_table = table(200, 20);  %测试数据R=200,H=20
            zj_table = table(app.RKnob.Value, app.HKnob.Value);
            zj_table.Properties.VariableNames{'Var1'} = 'VarName1';
            zj_table.Properties.VariableNames{'Var2'} = 'VarName2';
%             zj_predict = trainedModel.predictFcn(zj_table);    %3.11
            zj_predict = zjmodel.predictFcn(zj_table); %4.19

            
            
            % 摩擦数据预测
%             load mc_model.mat;
%             load ('mc_model.mat');
            exampleObject = matfile('mc_model.mat');
            mcmodel= exampleObject.trainedModel;
            
%             mc_table = table(200, 270, 90);  %测试数据R=200,压力270,摆角30
            mc_table = table(app.R2Knob.Value, app.MPaKnob.Value, app.ThetaKnob.Value);
            mc_table.Properties.VariableNames{'Var1'} = 'VarName1';
            mc_table.Properties.VariableNames{'Var2'} = 'VarName2';
            mc_table.Properties.VariableNames{'Var3'} = 'VarName3';
            % mc_predict = trainedClassifier.predictFcn(mc_table);
            
%             mc_predict = trainedModel.predictFcn(mc_table); %3.11
            mc_predict = mcmodel.predictFcn(mc_table); %4.19
          
            %% 融合预测概率
%             alpha = app.alphaKnob.Value; %设置撞击概率权重
%             mix_predict = alpha * zj_predict + (1-alpha) * mc_predict;
      
            % 异常判定
%             if ((app.REditField.Value<=0) || (app.PEditField.Value<=0) || (app.ThetaEditField.Value<=0) ...
%                     || (app.PEditField.Value<=0) ||  (app.AlphaEditField.Value<0) || (app.AlphaEditField.Value>1) )
%             s = '数据不足或异常';
%             app.ZJEditField.Value = num2str(s);
%             app.MCEditField.Value = num2str(s);
%             app.MixEditField.Value = num2str(s);
%             
%             else
            % 预测结果打印
            app.ZJEditField.Value = num2str(zj_predict);
            app.MCEditField.Value = num2str(mc_predict);
%             app.MixEditField.Value = num2str(mix_predict);
            
%             end
            % 灯光显示,响应即红灯
            if zj_predict == 1
                set(app.ZJLamp, 'Color', [1,0,0]) 
            else
                set(app.ZJLamp, 'Color', [0,1,0])
            end
            
            if mc_predict == 1
                set(app.MCLamp, 'Color', [1,0,0]) 
            else
                set(app.MCLamp, 'Color', [0,1,0])
            end
            
%             if mix_predict >=0.5
%                 set(app.MixLamp, 'Color', [1,0,0]) 
%             else
%                 set(app.MixLamp, 'Color', [0,1,0])
%             end

            
        end

        % Value changed function: RKnob
        function RKnobValueChanged(app, event)
%             value = app.RKnob.Value;
            app.REditField.Value = num2str(app.RKnob.Value);
        end

        % Value changed function: HKnob
        function HKnobValueChanged(app, event)
%             value = app.HKnob.Value;
            app.HEditField.Value = num2str(app.HKnob.Value);
        end

        % Callback function
        function alphaKnobValueChanged(app, event)
%             value = app.alphaKnob.Value;
            app.alphaEditField.Value = num2str(app.alphaKnob.Value);
        end

        % Value changed function: R2Knob
        function R2KnobValueChanged(app, event)
%             value = app.R2Knob.Value;
            app.R2EditField.Value = num2str(app.R2Knob.Value);
        end

        % Value changed function: ThetaKnob
        function ThetaKnobValueChanged(app, event)
%             value = app.ThetaKnob.Value;
            app.ThetaEditField.Value = num2str(app.ThetaKnob.Value);
        end

        % Value changed function: MPaKnob
        function MPaKnobValueChanged(app, event)
%             value = app.MPaKnob.Value;
            app.MPaEditField.Value = num2str(app.MPaKnob.Value);
        end

        % Button pushed function: ZJButton
        function ZJButtonPushed(app, event)
            % 导入撞击表格数据
            % 按下导入撞击数据按钮
            
%             输入excel的相对或绝对路径
            app.xls_dir = app.ZJFilePathEditField.Value;
            app.data_example = xlsread(app.xls_dir, 'sheet1');

            % 比较v和m大小。判定n取vi还是mi
            [app.Ni_Stimulus_Xi,~] = get_Ni_Stimulus_Xi(app.data_example);
            
            app.Stimulus_Xi = app.data_example(:,1); %读取刺激量xi
            
            % 获取中位数X0 以及台阶数矩阵,步长d
            [app.stage_mitrix_i,~,~] =...
                get_stage_mitrix_and_X0(app.Stimulus_Xi);
            
            % 计算A B M b 的模块
            app.nABMb = calculate_parameter_n_A_B_M_b(app.Ni_Stimulus_Xi,app.stage_mitrix_i);
            app.parameter_n = app.nABMb.parameter_n;
            app.parameter_A = app.nABMb.parameter_A;
            app.parameter_B = app.nABMb.parameter_B;
            app.parameter_M = app.nABMb.parameter_M;
            app.parameter_little_b = app.nABMb.parameter_little_b;      
            
%             %数据有效性判定 1有效 0 无效
%             data_validity = check_for_data_validity(parameter_M);
%             if data_validity == 1
%                 s = '数据有效，请查表输入G,H';
%             else 
%                 s = '数据无效，M<0.25，请重新导入';
%             end
%             % 显示有效性结果
%             app.VaildEditField.Value = s;
            
            % 表格数据显示到界面上
            app.ZJUITable.Data = app.data_example;
            
%---------------------------------------------------------------------            
            
            % 计算ρ 
            app.parameter_M = roundn(app.parameter_M, -2); %保留两位小数
            if (app.parameter_M > 0.3)
                app.parameter_rou = 1.62 * ( app.parameter_M + 0.029 );
            else
%                 s = 'M<0.3, 请查表ρ(M,b)，自行输入ρ值！';
%                 app.NoteEditField.Value = s;
                % 自行给app.rouEditField.Value赋值
                app.parameter_rou = app.rouEditField.Value;
            end

            % 显示计算数据
            app.MEditField.Value = num2str(app.parameter_M);
            app.bEditField.Value = num2str(app.parameter_little_b);
            app.rouEditField.Value = num2str(app.parameter_rou);
            

        end

        % Button pushed function: MCButton
        function MCButtonPushed(app, event)
           % 按下导入摩擦数据按钮
            
%             输入excel的相对或绝对路径
            app.xls_dir2 = app.MCFilePathEditField.Value;
            app.mc_data = xlsread(app.xls_dir2, 'sheet1');
            
            app.data_col = length(app.mc_data)/5;
            app.data_example2_matrix = reshape(app.mc_data, app.data_col, 5 ); %美化界面，五列展示
            
              % 表格数据显示到界面上
            app.MCUITable.Data = app.data_example2_matrix;
            
%             app.MCNoteEditField.Value = '置信水平,摩擦安全设计值需自行输入';
%---------------------------------------------------------------------  

            %相关参数设置
            app.zhixindu = str2double(app.MCalphaEditField.Value);
%             app.mc_th = str2double(app.MClimEditField.Value);
%             zhixindu = 0.95; %置信度
%             mc_th = 0.55; %安全性设计值

            % 计算试验数据的摩擦感度p
            app.explore_num = length(find(app.mc_data == 1));
            app.mc_prob = app.explore_num/length(app.mc_data);

            % 估计p的置信区间
            % 本质是一元二次方程
            app.mc_Z = get_Up((1-app.zhixindu) /2);% Za/2
            app.f_a = length(app.mc_data) +  app.mc_Z^2;
            app.f_b = -(2*length(app.mc_data)*app.mc_prob + app.mc_Z^2);
            app.f_c = length(app.mc_data)* (app.mc_prob^2);
            app.f_delta = sqrt(app.f_b^2 - 4*app.f_a*app.f_c);
            app.mc_plow = (-app.f_b - app.f_delta) / (2*app.f_a); %p2
            app.mc_phigh = (-app.f_b + app.f_delta) / (2*app.f_a); %p1
            app.mc_between = [app.mc_plow, app.mc_phigh];
            
            % 显示p和区间 
            app.P0EditField.Value = num2str(app.mc_prob);
            app.MCbetweenEditField.Value = num2str(app.mc_between);
            
            
        end

        % Button pushed function: QMUButton
        function QMUButtonPushed(app, event)
            % 按下QMU评估按钮 计算QMU
            % 撞击Q
%             data_example = xlsread(app.xls_dir, 'sheet1');
% 
            [~,explode_or_unexplode_data_flag] = get_Ni_Stimulus_Xi(app.data_example);
%             
%             Stimulus_Xi = data_example(:,1); %读取刺激量xi
%             
            % 获取中位数X0 以及台阶数矩阵,步长d
            [~,Stimulus_median_X0,parameter_Step_sized] =...
                get_stage_mitrix_and_X0(app.Stimulus_Xi);
%             
%             % 计算A B M b 的模块
%             nABMb = calculate_parameter_n_A_B_M_b(Ni_Stimulus_Xi,stage_mitrix_i);
%             parameter_n = nABMb.parameter_n;
%             parameter_A = nABMb.parameter_A;
%             parameter_B = nABMb.parameter_B;
%             parameter_M = nABMb.parameter_M;
%             parameter_little_b = nABMb.parameter_little_b;      
%             
%           
%             % 计算ρ 
%             parameter_M = roundn(parameter_M, -2); %保留两位小数
%             if (parameter_M > 0.3)
%                 parameter_rou = 1.62 * ( parameter_M + 0.029 );
%             else
% %                 s = 'M<0.3, 请查表ρ(M,b)，自行输入ρ值！';
% %                 app.MCNoteEditField.Value = s;
%                 % 自行给app.rouEditField.Value赋值
%                 parameter_rou = app.rouEditField.Value;
%             end

            % 显示计算数据
%             app.MEditField.Value = num2str(parameter_M);
%             app.bEditField.Value = num2str(parameter_little_b);
%             app.rouEditField.Value = num2str(parameter_rou);
            
            % 计算mu-hat
            parameter_miu = calculate_parameter_miu(...
                Stimulus_median_X0,explode_or_unexplode_data_flag,...
                app.parameter_A, app.parameter_n, parameter_Step_sized);            
            
            % 计算sigma-hat
            Std_Dev_sigma = calculate_Std_Dev_sigma(app.parameter_rou,parameter_Step_sized);  
         
            % 由自行输入的G H 
            % 计算sigma_mean sigma_variance
            parameter_G = str2double(app.GEditField.Value);
            parameter_H = str2double(app.H2EditField.Value);
            sigma_mean = parameter_G * Std_Dev_sigma / sqrt(app.parameter_n);
            sigma_variance = parameter_H * Std_Dev_sigma / sqrt(app.parameter_n);

            % 由自行输入的置信水平
            prob = str2double(app.UpEditField.Value);
            % 计算sigma_Xp
            mu = 0;
            sigma = 1;
            pd = makedist('Normal','mu',mu,'sigma',sigma);
            p = 1 - prob;
            Up = icdf(pd,p);
%             p = 0.0001;
            sigma_explode_prob_Xp = sqrt(sigma_mean^2 + (Up * sigma_variance)^2 );
         
            % 计算置信区间（上下限）
%             explode_prob_Xp_QuantileU = ...
%                 calculate_explode_prob_Xp_QuantileU(explode_prob_Xp,Confidence_level,sigma_explode_prob_Xp);
            %撞击感度取置信下限
            % 计算M=Xth-X0
            X_th = parameter_miu - abs(Up) * Std_Dev_sigma;

%             X_zero = str2double(app.X0EditField.Value);
            % 显示安全性设计值X0，若满足不等式大于1，X0小于X_pl即可
            
            X_pl = X_th - abs(Up) * sigma_explode_prob_Xp;     
            
            if app.DropDown.Value == char('自动计算')
                X0 = X_pl-0.1;
            else
                X0 = str2double(app.X0EditField.Value);  % 可以自定义修改安全性设计值
            end
         
            app.ZJ_M = X_th - X0;
            app.ZJ_U = X_th - X_pl; 
            % 计算Q
            app.ZJ_Q = app.ZJ_M ./ app.ZJ_U;
            
            % 显示计算数据和指示灯（Q值小于为红灯）
            app.XthEditField.Value = num2str(X_th);
            app.X0EditField.Value = num2str(X0);
            app.ZJMEditField.Value = num2str(app.ZJ_M);
            app.ZJUEditField.Value = num2str(app.ZJ_U);
            app.ZJQEditField.Value = num2str(app.ZJ_Q);
            while app.ZJ_Q<=1
                set(app.ZJQLamp, 'Color', [1,0,0])
            end
   
            % 显示至仪表
            app.ZJGauge.Value = app.ZJ_Q;
%---------------------------------------------------------------------   
%---------------------------------------------------------------------   
%---------------------------------------------------------------------   
            % 摩擦Q
            % 按下导入摩擦数据按钮
            
%             mc_data = xlsread(app.xls_dir2, 'sheet1');
%             
%             %相关参数设置
%             zhixindu = str2double(app.MCalphaEditField.Value);
%             app.mc_th = str2double(app.MClimEditField.Value);
% % app.mc_th = str2double(app.testEditField.Value);
%             
% %             zhixindu = 0.95; %置信度
% %             mc_th = 0.956; %安全性设计值
%             
%             % 计算试验数据的摩擦感度p
%             explore_num = length(find(mc_data == 1));
%             mc_prob = explore_num/length(mc_data);
%             
%             % 估计p的置信区间
%             % 本质是一元二次方程
%             mc_Z = get_Up((1-zhixindu) /2);% Za/2
%             f_a = length(mc_data) +  mc_Z^2;
%             f_b = -(2*length(mc_data)*mc_prob + mc_Z^2);
%             f_c = length(mc_data)* (mc_prob^2);
%             f_delta = sqrt(f_b^2 - 4*f_a*f_c);
%             mc_plow = (-f_b - f_delta) / (2*f_a); %p1
%             mc_phigh = (-f_b + f_delta) / (2*f_a); %p2
%             mc_between = [mc_plow, mc_phigh];
%             
%             % 显示p和区间 
%             app.P0EditField.Value = num2str(mc_prob);
%             app.MCbetweenEditField.Value = num2str(mc_between);
            
            % B类不确定度评定
            % 计算sigma_miu
            prob_a = (app.mc_phigh - app.mc_plow) / 2;
            mc_v = length(app.mc_data)-1;
            mc_t = tinv(1-((1-app.zhixindu) /2), mc_v); %计算t值
            mc_ux = prob_a / mc_t;
            % 计算sigma_sigma
            mc_sigmasigma = mc_ux/sqrt(2* mc_v);
            % 计算合成sigma_plow
            mc_sigmaplow = sqrt(mc_ux^2 + (mc_t*mc_sigmasigma)^2);
            
        
            
%             % 上限版本
%             % 若满足不等式大于1， mc_th > mc_phigh + mc_sigmaplow 即可
%             mc_th = app.mc_phigh + mc_sigmaplow + 0.01 ;
%             
%             app.MC_M = mc_th - app.mc_phigh;
%             
%             % 计算U
%             % MC_U = abs(get_Up(zhixindu)) * mc_sigmaplow;
%             app.MC_U = mc_sigmaplow;
            
            % 下限版本
            % 若满足不等式大于1， mc_th < mc_plow - mc_sigmaplow 即可
            
%             swith app.DropDown.Value
%                 case '计算生成'        
%                     mc_th = app.mc_plow - mc_sigmaplow - 0.01;    
%                 otherwise             
%                     mc_th = str2double(app.MClimEditField.Value); % 可以自定义修改安全性设计值
%                     
%             end
            
            if app.DropDown.Value == char('自动计算')
                mc_th = app.mc_plow - mc_sigmaplow - 0.01;
            else
                mc_th = str2double(app.MClimEditField.Value); % 可以自定义修改安全性设计值
            end
            
            app.MC_M = app.mc_plow - mc_th;
                
            % 计算U
            % MC_U = abs(get_Up(zhixindu)) * mc_sigmaplow;
            app.MC_U = mc_sigmaplow;


            % 计算Q
            app.MC_Q = app.MC_M ./ app.MC_U;
            
%             显示计算数据
            app.Xth2EditField.Value = num2str(app.mc_plow); %Xth
            app.MClimEditField.Value = num2str(mc_th); %X0  
            app.MCMEditField.Value = num2str(app.MC_M);
            app.MCUEditField.Value = num2str(app.MC_U);
            app.MCQEditField.Value = num2str(app.MC_Q);
            while app.MC_Q<=1
                set(app.MCQLamp, 'Color', [1,0,0])
            end         

            % 显示至仪表
            app.MCGauge.Value = app.MC_Q;

%---------------------------------------------------------------------   
%---------------------------------------------------------------------   
%---------------------------------------------------------------------   

            % 多元QMU评估Q值            
            mixM = sqrt((X_th-X0)^2 + (app.mc_plow-mc_th)^2);
            mixU = sqrt((X_th-X_pl)^2 + (mc_sigmaplow)^2 );
            
            app.mixQ = mixM ./ mixU;
            
            app.MixMEditField.Value = num2str(mixM);
            app.MixUEditField.Value = num2str(mixU);
            app.MixQEditField.Value = num2str(app.mixQ);
            
%---------------------------------------------------------------------   
%---------------------------------------------------------------------   
%---------------------------------------------------------------------   

            % 显示Q值的图像
            ax = app.UIAxes;
            ax.XLim = [0 3];
            ax.YLim = [0 3];
%             x = [0 1 1 0];
%             y = [0 0 1 1];
%             x = [1 3 3 1];
%             y = [1 1 3 3];
            x = [0 3 3 1 1 0];
            y = [0 0 1 1 3 3];

            patch(ax, x, y, 'red');
            hold(ax, 'on');
            plot(ax, app.ZJ_Q, app.MC_Q, 'd',...
                'MarkerFaceColor', 'g',...
                'MarkerSize',10);
            
            % 显示撞击QMU图像
            
            axzj = app.UIZJAxes;
            
            axzj.YLim = [X0-0.2 X_th+0.2];
            xx = [1 2];
            x1 = plot(axzj, xx, [X_th X_th],'r:');
            hold(axzj, 'on');
            x2 = plot(axzj, xx, [X_pl X_pl],'g-');
            hold(axzj, 'on');
            x3 = plot(axzj, xx, [X0 X0],'k-');
            hold(axzj, 'on');
            legend(axzj, [x1(1),x2(1),x3(1)],'临界阈值','单侧置信上限','安全设计值')
            
            % 显示摩擦QMU图像
            axmc = app.UIMCAxes;
            
            axmc.YLim = [mc_th-0.1, app.mc_plow+0.1];
            x4 = plot(axmc, xx, [app.mc_plow app.mc_plow],'r:');
            hold(axmc, 'on');
            x5 = plot(axmc, xx, [app.mc_plow-mc_sigmaplow app.mc_plow-mc_sigmaplow],'g-');
            hold(axmc, 'on');
            x6 = plot(axmc, xx, [mc_th mc_th],'k-');           
            hold(axmc, 'on');
            legend(axmc, [x4(1),x5(1),x6(1)],'临界阈值','单侧置信上限','安全设计值')
            
%---------------------------------------------------------------------   
%---------------------------------------------------------------------   
%---------------------------------------------------------------------   
            
            % 显示雷达图
            D1 = [app.ZJ_Q, app.MC_Q, 0, 0, 0];
            D2 = [1, 1, 0, 0, 0];          
            lim = [0,3;0,3;0,3;0,3;0,3];
            labels = {'撞击', '摩擦', '未定义', '未定义', '未定义'};
%            legendlables = {'test','threshold'};
            Draw_radar(D1,lim,labels);
            hold on;
            Draw_radar(D2,lim,labels);
            
            clear all; % 按下按钮后。计算结果清空，重新评估
            
            
%----------------------------以下为测试内容------------------------
%             % 更新至2022.2.22 待修改
%             % 测试是否可以在app上画雷达图 不生成 新的界面
%             
%             % function Draw_radar(data,lim,labels)
%             %data是要画图的数据（根据数据的个数来确定雷达图的轴数）
%             %lim是各指标画图上下限范围
%             %labels是坐标轴名称
%             data = [ZJ_Q, MC_Q, 0, 0, 0]; 
%             lim = [0,3;0,3;0,3;0,3;0,3];
%             labels = {'撞击', '摩擦', '未定义', '未定义', '未定义'};
%             
%             ax2 = app.UIZJAxes;
%             
%             n=length(data);%维度
%             adj_data=zeros(n,1);
%             point=zeros(n,2);
%             
%             set(gca,'units','normal','pos',[0 0 1 1]);
% %             axis off
% %             axis equal
% %             hold on
% 
%             
% 
%             theta_last=pi/2;
%             for i=1:n
%                 theta=2*pi/n*i+pi/2;
%                 plot(ax2, [0,500*cos(theta)],[0,500*sin(theta)],'k-','linewidth',2);
%                 for j=1:5
%                    plot(ax2, [j*100*cos(theta_last),j*100*cos(theta)],[j*100*sin(theta_last),j*100*sin(theta)],'--','linewidth',0.75,'color',[0.5,0.5,0.5]);
%                 end
%                 
%                 theta_last=theta;
%                 if data(i)<lim(i,1)
%                     adj_data(i)=0;
%                 elseif data(i)>lim(i,2)
%                     adj_data(i)=500;
%                 else
%                     adj_data(i)=(data(i)-lim(i,1))/(lim(i,2)-lim(i,1))*500;
%                 end
%                 point(i,1:2)=[adj_data(i)*cos(theta);adj_data(i)*sin(theta)];
%                 text_around(510*cos(theta),510*sin(theta),labels{i},theta);
%             end
%             
%             for i=1:n
%                 theta=2*pi/n*i+pi/2;
%                 for j=1:5
%                     text_around(j*100*cos(theta),j*100*sin(theta),num2str(lim(i,1)+(lim(i,2)-lim(i,1))/5*j),theta+pi/2,7);
%                 end
%             end
%             plot(ax2, [point(:,1);point(1,1)],[point(:,2);point(1,2)],'k-','linewidth',0.8);
%             fill(point(:,1),point(:,2),[0.9 0.9 0.7])
%             alpha(0.5);
%             texts=findobj(gca,'Type','Text');
%             minx=-300;
%             maxx=300;
%             miny=-300;
%             maxy=300;
%             for i=1:length(texts)
%                 rect=get(texts(i),'Extent');
%                 x=rect(1);
%                 y=rect(2);
%                 dx=rect(3);
%                 dy=rect(4);
%                 if x<minx
%                     minx=x;
%                 elseif x+dx>maxx
%                     maxx=x+dx;
%                 end
%                 if y<miny
%                     miny=y;
%                 elseif y+dy>maxy
%                     maxy=y+dy;
%                 end
%             end
%             axis([minx-50,maxx+50,miny-20,maxy+20]);
%                  
%             
%             hold(ax2,'on');
%             
%             
%             
%             
%             
%             D2 = [1, 1, 0, 0, 0]; 
% %             lim = [0,3;0,3;0,3;0,3;0,3];
% %             labels = {'撞击', '摩擦', '未定义', '未定义', '未定义'};
%             
%             ax2 = app.UIZJAxes;
%             
%             n=length(D2);%维度
%             adj_data=zeros(n,1);
%             point=zeros(n,2);
%             
%             set(gca,'units','normal','pos',[0 0 1 1]);
% %             axis off
% %             axis equal
% %             hold on
% 
%             theta_last=pi/2;
%             for i=1:n
%                 theta=2*pi/n*i+pi/2;
%                 plot(ax2, [0,500*cos(theta)],[0,500*sin(theta)],'k-','linewidth',2);
%                 for j=1:5
%                    plot(ax2, [j*100*cos(theta_last),j*100*cos(theta)],[j*100*sin(theta_last),j*100*sin(theta)],'--','linewidth',0.75,'color',[0.5,0.5,0.5]);
%                 end
%                 
%                 theta_last=theta;
%                 if D2(i)<lim(i,1)
%                     adj_data(i)=0;
%                 elseif D2(i)>lim(i,2)
%                     adj_data(i)=500;
%                 else
%                     adj_data(i)=(D2(i)-lim(i,1))/(lim(i,2)-lim(i,1))*500;
%                 end
%                 point(i,1:2)=[adj_data(i)*cos(theta);adj_data(i)*sin(theta)];
%                 text_around(510*cos(theta),510*sin(theta),labels{i},theta);
%             end
%             
%             for i=1:n
%                 theta=2*pi/n*i+pi/2;
%                 for j=1:5
%                     text_around(j*100*cos(theta),j*100*sin(theta),num2str(lim(i,1)+(lim(i,2)-lim(i,1))/5*j),theta+pi/2,7);
%                 end
%             end
%             plot(ax2, [point(:,1);point(1,1)],[point(:,2);point(1,2)],'k-','linewidth',0.8);
%             fill(point(:,1),point(:,2),[0.9 0.9 0.7])
%             alpha(0.5);
%             texts=findobj(gca,'Type','Text');
%             minx=-300;
%             maxx=300;
%             miny=-300;
%             maxy=300;
%             for i=1:length(texts)
%                 rect=get(texts(i),'Extent');
%                 x=rect(1);
%                 y=rect(2);
%                 dx=rect(3);
%                 dy=rect(4);
%                 if x<minx
%                     minx=x;
%                 elseif x+dx>maxx
%                     maxx=x+dx;
%                 end
%                 if y<miny
%                     miny=y;
%                 elseif y+dy>maxy
%                     maxy=y+dy;
%                 end
%             end
%             axis([minx-50,maxx+50,miny-20,maxy+20]);
            
            
        end

        % Value changed function: REditField
        function REditFieldValueChanged(app, event)
%             value = app.REditField.Value;
            app.RKnob.Value = str2double(app.REditField.Value);

        end

        % Value changed function: HEditField
        function HEditFieldValueChanged(app, event)
            app.HKnob.Value = str2double(app.HEditField.Value);
            
        end

        % Callback function
        function alphaEditFieldValueChanged(app, event)
            app.alphaKnob.Value = str2double(app.alphaEditField.Value);
            
        end

        % Value changed function: R2EditField
        function R2EditFieldValueChanged(app, event)
            app.R2Knob.Value = str2double(app.R2EditField.Value);
            
        end

        % Value changed function: ThetaEditField
        function ThetaEditFieldValueChanged(app, event)
            app.ThetaKnob.Value = str2double(app.ThetaEditField.Value);
            
        end

        % Value changed function: MPaEditField
        function MPaEditFieldValueChanged(app, event)
            app.MPaKnob.Value = str2double(app.MPaEditField.Value);
            
        end

        % Button pushed function: reportButton
        function reportButtonPushed(app, event)
            % 打印评估结果
            
            % 3.8 第一版，简陋版
            % 4.20 更新 第二版
            if (app.ZJ_Q>1) && (app.MC_Q>1)
                opts = struct('WindowStyle','modal', ...
                    'Interpreter','tex');
                f = msgbox({'\bf\fontsize{15}撞击感度满足可靠性要求'; ...
                    '\bf\fontsize{15}摩擦感度满足可靠性要求'; ...
                    '\bf\fontsize{15}综合QMU评估：满足可靠性要求'}, ...
                '评估结果判定', ...
                opts);
            elseif (app.ZJ_Q>1) && (app.MC_Q<1) && (app.mixQ>1)
                opts = struct('WindowStyle','modal', ...
                    'Interpreter','tex');
                f = msgbox({'\bf\fontsize{15}撞击感度满足可靠性要求'; ...
                    '\bf\fontsize{15}摩擦感度不满足可靠性要求'; ...
                    '\bf\fontsize{15}综合QMU评估：满足可靠性要求'}, ...
                '评估结果判定', ...
                'error', ...
                opts);                
           elseif (app.ZJ_Q>1) && (app.MC_Q<1) && (app.mixQ<1)
                opts = struct('WindowStyle','modal', ...
                    'Interpreter','tex');
                f = msgbox({'\bf\fontsize{15}撞击感度满足可靠性要求'; ...
                    '\bf\fontsize{15}摩擦感度不满足可靠性要求'; ...
                    '\bf\fontsize{15}综合QMU评估：不满足可靠性要求'}, ...
                '评估结果判定', ...
                'error', ...
                opts);     
            elseif (app.ZJ_Q<1) && (app.MC_Q>1) && (app.mixQ>1)
                opts = struct('WindowStyle','modal', ...
                    'Interpreter','tex');
                f = msgbox({'\bf\fontsize{15}撞击感度不满足可靠性要求'; ...
                    '\bf\fontsize{15}摩擦感度满足可靠性要求'; ...
                    '\bf\fontsize{15}综合QMU评估：满足可靠性要求'}, ...
                '评估结果判定', ...
                'error', ...
                opts);    
            elseif (app.ZJ_Q<1) && (app.MC_Q>1) && (app.mixQ<1)
                opts = struct('WindowStyle','modal', ...
                    'Interpreter','tex');
                f = msgbox({'\bf\fontsize{15}撞击感度不满足可靠性要求'; ...
                    '\bf\fontsize{15}摩擦感度满足可靠性要求'; ...
                    '\bf\fontsize{15}综合QMU评估：不满足可靠性要求'}, ...
                '评估结果判定', ...
                'error', ...
                opts);  
            else
                opts = struct('WindowStyle','modal', ...
                    'Interpreter','tex');
                f = msgbox({'\bf\fontsize{15}撞击感度不满足可靠性要求'; ...
                    '\bf\fontsize{15}摩擦感度不满足可靠性要求'; ...
                    '\bf\fontsize{15}综合QMU评估：不满足可靠性要求'}, ...
                '评估结果判定', ...
                'error', ...
                opts);                
            end
            
% app.testEditField.Value = num2str(app.ZJ_Q);
        end

        % Button pushed function: Button
        function ButtonPushed(app, event)
            % 关闭界面
            ques = questdlg('确定要关闭吗','提示','是','否','是');
            switch ques
                case '是'
                    delete(app.UIFigure);
                    return;
                case '否'
                    return;
            end
            
        end
    end

    % Component initialization
    methods (Access = private)

        % Create UIFigure and components
        function createComponents(app)

            % Create UIFigure and hide until all components are created
            app.UIFigure = uifigure('Visible', 'off');
            app.UIFigure.Color = [0.8 0.8 0.8];
            app.UIFigure.Position = [100 100 1291 888];
            app.UIFigure.Name = 'MATLAB App';

            % Create Label
            app.Label = uilabel(app.UIFigure);
            app.Label.BackgroundColor = [0.902 0.902 0.902];
            app.Label.HorizontalAlignment = 'center';
            app.Label.FontName = '等线';
            app.Label.FontSize = 45;
            app.Label.FontWeight = 'bold';
            app.Label.FontColor = [0.6353 0.0784 0.1843];
            app.Label.Position = [241 819 742 48];
            app.Label.Text = '火炸药机械感度可靠性多元评估系统';

            % Create Panel
            app.Panel = uipanel(app.UIFigure);
            app.Panel.ForegroundColor = [0.502 0.502 0.502];
            app.Panel.BorderType = 'none';
            app.Panel.Title = '机器学习预测响应-输入                                                                                  输出';
            app.Panel.BackgroundColor = [0.902 0.902 0.902];
            app.Panel.FontWeight = 'bold';
            app.Panel.FontSize = 25;
            app.Panel.Position = [20 540 1257 267];

            % Create Label_4
            app.Label_4 = uilabel(app.Panel);
            app.Label_4.FontSize = 22;
            app.Label_4.Position = [17 194 137 29];
            app.Label_4.Text = '撞击感度试验';

            % Create Label_5
            app.Label_5 = uilabel(app.Panel);
            app.Label_5.FontSize = 22;
            app.Label_5.Position = [363 194 137 29];
            app.Label_5.Text = '摩擦感度试验';

            % Create REditField
            app.REditField = uieditfield(app.Panel, 'text');
            app.REditField.ValueChangedFcn = createCallbackFcn(app, @REditFieldValueChanged, true);
            app.REditField.HorizontalAlignment = 'right';
            app.REditField.Position = [47 10 79 22];

            % Create mKnobLabel
            app.mKnobLabel = uilabel(app.Panel);
            app.mKnobLabel.HorizontalAlignment = 'center';
            app.mKnobLabel.FontSize = 16;
            app.mKnobLabel.Position = [40 47 96 22];
            app.mKnobLabel.Text = '颗粒直径/μm';

            % Create RKnob
            app.RKnob = uiknob(app.Panel, 'continuous');
            app.RKnob.Limits = [0 500];
            app.RKnob.MajorTicks = [0 50 100 150 200 250 300 350 400 450 500];
            app.RKnob.ValueChangedFcn = createCallbackFcn(app, @RKnobValueChanged, true);
            app.RKnob.MinorTicks = [];
            app.RKnob.Position = [57 103 60 60];

            % Create cmLabel
            app.cmLabel = uilabel(app.Panel);
            app.cmLabel.HorizontalAlignment = 'center';
            app.cmLabel.FontSize = 16;
            app.cmLabel.Position = [216 37 64 42];
            app.cmLabel.Text = {'落高/cm'; '(取对数)'};

            % Create HKnob
            app.HKnob = uiknob(app.Panel, 'continuous');
            app.HKnob.Limits = [0 2];
            app.HKnob.MajorTicks = [0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 2];
            app.HKnob.MajorTickLabels = {'0', '0.2', '0.4', '0.6', '0.8', '1', '1.2', '1.4', '1.6', '1.8', '2'};
            app.HKnob.ValueChangedFcn = createCallbackFcn(app, @HKnobValueChanged, true);
            app.HKnob.MinorTicks = [];
            app.HKnob.Position = [216 103 60 60];

            % Create MPaKnobLabel
            app.MPaKnobLabel = uilabel(app.Panel);
            app.MPaKnobLabel.HorizontalAlignment = 'center';
            app.MPaKnobLabel.FontSize = 16;
            app.MPaKnobLabel.Position = [684 47 75 22];
            app.MPaKnobLabel.Text = '压力/MPa';

            % Create MPaKnob
            app.MPaKnob = uiknob(app.Panel, 'continuous');
            app.MPaKnob.Limits = [0 400];
            app.MPaKnob.ValueChangedFcn = createCallbackFcn(app, @MPaKnobValueChanged, true);
            app.MPaKnob.Position = [690 103 60 60];

            % Create ThetaKnobLabel
            app.ThetaKnobLabel = uilabel(app.Panel);
            app.ThetaKnobLabel.HorizontalAlignment = 'center';
            app.ThetaKnobLabel.FontSize = 16;
            app.ThetaKnobLabel.Position = [526 47 83 22];
            app.ThetaKnobLabel.Text = '摆角/Theta';

            % Create ThetaKnob
            app.ThetaKnob = uiknob(app.Panel, 'continuous');
            app.ThetaKnob.Limits = [0 90];
            app.ThetaKnob.MajorTicks = [0 15 30 45 60 75 90];
            app.ThetaKnob.ValueChangedFcn = createCallbackFcn(app, @ThetaKnobValueChanged, true);
            app.ThetaKnob.Position = [536 103 60 60];

            % Create mKnob_2Label
            app.mKnob_2Label = uilabel(app.Panel);
            app.mKnob_2Label.HorizontalAlignment = 'center';
            app.mKnob_2Label.FontSize = 16;
            app.mKnob_2Label.Position = [371 47 96 22];
            app.mKnob_2Label.Text = '颗粒直径/μm';

            % Create R2Knob
            app.R2Knob = uiknob(app.Panel, 'continuous');
            app.R2Knob.Limits = [0 500];
            app.R2Knob.MajorTicks = [0 50 100 150 200 250 300 350 400 450 500];
            app.R2Knob.ValueChangedFcn = createCallbackFcn(app, @R2KnobValueChanged, true);
            app.R2Knob.MinorTicks = [];
            app.R2Knob.Position = [388 103 60 60];

            % Create HEditField
            app.HEditField = uieditfield(app.Panel, 'text');
            app.HEditField.ValueChangedFcn = createCallbackFcn(app, @HEditFieldValueChanged, true);
            app.HEditField.HorizontalAlignment = 'right';
            app.HEditField.Position = [206 10 79 22];

            % Create R2EditField
            app.R2EditField = uieditfield(app.Panel, 'text');
            app.R2EditField.ValueChangedFcn = createCallbackFcn(app, @R2EditFieldValueChanged, true);
            app.R2EditField.HorizontalAlignment = 'right';
            app.R2EditField.Position = [378 10 79 22];

            % Create ThetaEditField
            app.ThetaEditField = uieditfield(app.Panel, 'text');
            app.ThetaEditField.ValueChangedFcn = createCallbackFcn(app, @ThetaEditFieldValueChanged, true);
            app.ThetaEditField.HorizontalAlignment = 'right';
            app.ThetaEditField.Position = [526 10 79 22];

            % Create MPaEditField
            app.MPaEditField = uieditfield(app.Panel, 'text');
            app.MPaEditField.ValueChangedFcn = createCallbackFcn(app, @MPaEditFieldValueChanged, true);
            app.MPaEditField.HorizontalAlignment = 'right';
            app.MPaEditField.Position = [682 10 79 22];

            % Create MLPredictButton
            app.MLPredictButton = uibutton(app.Panel, 'push');
            app.MLPredictButton.ButtonPushedFcn = createCallbackFcn(app, @MLPredictButtonPushed, true);
            app.MLPredictButton.BackgroundColor = [1 0.4118 0.1608];
            app.MLPredictButton.FontSize = 22;
            app.MLPredictButton.FontColor = [1 1 1];
            app.MLPredictButton.Position = [834 171 125 37];
            app.MLPredictButton.Text = '预测响应值';

            % Create ZJLamp
            app.ZJLamp = uilamp(app.Panel);
            app.ZJLamp.Position = [1094 135 20 20];

            % Create MCLamp
            app.MCLamp = uilamp(app.Panel);
            app.MCLamp.Position = [1094 70 20 20];

            % Create Label_6
            app.Label_6 = uilabel(app.Panel);
            app.Label_6.HorizontalAlignment = 'right';
            app.Label_6.FontSize = 20;
            app.Label_6.Position = [866 130 85 26];
            app.Label_6.Text = '撞击响应';

            % Create ZJEditField
            app.ZJEditField = uieditfield(app.Panel, 'text');
            app.ZJEditField.FontSize = 16;
            app.ZJEditField.Position = [966 133 100 23];

            % Create Label_7
            app.Label_7 = uilabel(app.Panel);
            app.Label_7.HorizontalAlignment = 'right';
            app.Label_7.FontSize = 20;
            app.Label_7.Position = [866 64 85 26];
            app.Label_7.Text = '摩擦响应';

            % Create MCEditField
            app.MCEditField = uieditfield(app.Panel, 'text');
            app.MCEditField.FontSize = 16;
            app.MCEditField.Position = [966 67 100 23];

            % Create QMUPanel
            app.QMUPanel = uipanel(app.UIFigure);
            app.QMUPanel.AutoResizeChildren = 'off';
            app.QMUPanel.ForegroundColor = [0.502 0.502 0.502];
            app.QMUPanel.Title = 'QMU评估可靠性-输入                                            输出';
            app.QMUPanel.BackgroundColor = [0.902 0.902 0.902];
            app.QMUPanel.FontWeight = 'bold';
            app.QMUPanel.FontSize = 25;
            app.QMUPanel.Position = [20 7 1259 521];

            % Create ZJButton
            app.ZJButton = uibutton(app.QMUPanel, 'push');
            app.ZJButton.ButtonPushedFcn = createCallbackFcn(app, @ZJButtonPushed, true);
            app.ZJButton.BackgroundColor = [0 0.4471 0.7412];
            app.ZJButton.FontSize = 22;
            app.ZJButton.FontColor = [1 1 1];
            app.ZJButton.Tooltip = {'选择撞击数据Excel表格路径'};
            app.ZJButton.Position = [356 404 147 37];
            app.ZJButton.Text = '导入撞击数据';

            % Create ZJUITable
            app.ZJUITable = uitable(app.QMUPanel);
            app.ZJUITable.ColumnName = {'Xi'; 'Vi'; 'Mi'; 'Sum_Vi_Mi'};
            app.ZJUITable.RowName = {};
            app.ZJUITable.FontSize = 16;
            app.ZJUITable.Position = [22 227 280 172];

            % Create MCFilePathEditField
            app.MCFilePathEditField = uieditfield(app.QMUPanel, 'text');
            app.MCFilePathEditField.FontSize = 16;
            app.MCFilePathEditField.Tooltip = {'输入摩擦试验excel文件的完整路径'};
            app.MCFilePathEditField.Position = [40 174 262 26];
            app.MCFilePathEditField.Value = '.\mc_example.xlsx';

            % Create MCUITable
            app.MCUITable = uitable(app.QMUPanel);
            app.MCUITable.ColumnName = {'响应结果'; ''; ''; ''};
            app.MCUITable.RowName = {};
            app.MCUITable.FontSize = 16;
            app.MCUITable.Position = [14 9 288 145];

            % Create MCButton
            app.MCButton = uibutton(app.QMUPanel, 'push');
            app.MCButton.ButtonPushedFcn = createCallbackFcn(app, @MCButtonPushed, true);
            app.MCButton.BackgroundColor = [0 0.4471 0.7412];
            app.MCButton.FontSize = 22;
            app.MCButton.FontColor = [1 1 1];
            app.MCButton.Tooltip = {'选择摩擦数据Excel表格路径'};
            app.MCButton.Position = [350 163 147 37];
            app.MCButton.Text = '导入摩擦数据';

            % Create FilePathLabel
            app.FilePathLabel = uilabel(app.QMUPanel);
            app.FilePathLabel.HorizontalAlignment = 'right';
            app.FilePathLabel.FontSize = 20;
            app.FilePathLabel.Position = [18 448 84 24];
            app.FilePathLabel.Text = 'File Path';

            % Create ZJFilePathEditField
            app.ZJFilePathEditField = uieditfield(app.QMUPanel, 'text');
            app.ZJFilePathEditField.FontSize = 16;
            app.ZJFilePathEditField.Tooltip = {'输入撞击试验excel文件的完整路径'};
            app.ZJFilePathEditField.Position = [46 415 256 26];
            app.ZJFilePathEditField.Value = '.\zj_example.xlsx';

            % Create MEditFieldLabel
            app.MEditFieldLabel = uilabel(app.QMUPanel);
            app.MEditFieldLabel.HorizontalAlignment = 'right';
            app.MEditFieldLabel.FontSize = 16;
            app.MEditFieldLabel.Position = [343 337 25 22];
            app.MEditFieldLabel.Text = 'M';

            % Create MEditField
            app.MEditField = uieditfield(app.QMUPanel, 'text');
            app.MEditField.HorizontalAlignment = 'right';
            app.MEditField.FontSize = 16;
            app.MEditField.Position = [383 336 100 23];

            % Create Label_16
            app.Label_16 = uilabel(app.QMUPanel);
            app.Label_16.HorizontalAlignment = 'right';
            app.Label_16.FontSize = 16;
            app.Label_16.Position = [305 57 69 25];
            app.Label_16.Text = '置信区间';

            % Create MCbetweenEditField
            app.MCbetweenEditField = uieditfield(app.QMUPanel, 'text');
            app.MCbetweenEditField.HorizontalAlignment = 'right';
            app.MCbetweenEditField.Position = [381 60 117 22];

            % Create Label_18
            app.Label_18 = uilabel(app.QMUPanel);
            app.Label_18.HorizontalAlignment = 'right';
            app.Label_18.FontSize = 16;
            app.Label_18.Position = [308 93 69 22];
            app.Label_18.Text = '爆炸概率';

            % Create P0EditField
            app.P0EditField = uieditfield(app.QMUPanel, 'text');
            app.P0EditField.HorizontalAlignment = 'right';
            app.P0EditField.FontSize = 16;
            app.P0EditField.Position = [385 93 100 23];

            % Create bEditField_2Label
            app.bEditField_2Label = uilabel(app.QMUPanel);
            app.bEditField_2Label.HorizontalAlignment = 'right';
            app.bEditField_2Label.FontSize = 16;
            app.bEditField_2Label.Position = [343 307 25 22];
            app.bEditField_2Label.Text = 'b';

            % Create bEditField
            app.bEditField = uieditfield(app.QMUPanel, 'text');
            app.bEditField.HorizontalAlignment = 'right';
            app.bEditField.FontSize = 16;
            app.bEditField.Position = [383 306 100 23];

            % Create Label_19
            app.Label_19 = uilabel(app.QMUPanel);
            app.Label_19.HorizontalAlignment = 'right';
            app.Label_19.FontSize = 16;
            app.Label_19.Position = [343 274 25 22];
            app.Label_19.Text = 'ρ';

            % Create rouEditField
            app.rouEditField = uieditfield(app.QMUPanel, 'text');
            app.rouEditField.HorizontalAlignment = 'right';
            app.rouEditField.FontSize = 16;
            app.rouEditField.Tooltip = {'ρ可计算或查表得出'};
            app.rouEditField.Position = [383 273 100 23];

            % Create GEditField_2Label
            app.GEditField_2Label = uilabel(app.QMUPanel);
            app.GEditField_2Label.HorizontalAlignment = 'right';
            app.GEditField_2Label.FontSize = 16;
            app.GEditField_2Label.Position = [343 242 25 22];
            app.GEditField_2Label.Text = 'G';

            % Create GEditField
            app.GEditField = uieditfield(app.QMUPanel, 'text');
            app.GEditField.HorizontalAlignment = 'right';
            app.GEditField.FontSize = 16;
            app.GEditField.Tooltip = {'查表输入G值'};
            app.GEditField.Position = [383 241 100 23];
            app.GEditField.Value = '1.031';

            % Create HEditField_2Label
            app.HEditField_2Label = uilabel(app.QMUPanel);
            app.HEditField_2Label.HorizontalAlignment = 'right';
            app.HEditField_2Label.FontSize = 16;
            app.HEditField_2Label.Position = [343 211 25 22];
            app.HEditField_2Label.Text = 'H';

            % Create H2EditField
            app.H2EditField = uieditfield(app.QMUPanel, 'text');
            app.H2EditField.HorizontalAlignment = 'right';
            app.H2EditField.FontSize = 16;
            app.H2EditField.Tooltip = {'查表输入H值'};
            app.H2EditField.Position = [383 210 100 23];
            app.H2EditField.Value = '1.325';

            % Create Label_20
            app.Label_20 = uilabel(app.QMUPanel);
            app.Label_20.HorizontalAlignment = 'right';
            app.Label_20.FontSize = 16;
            app.Label_20.Position = [303 365 69 22];
            app.Label_20.Text = '置信水平';

            % Create UpEditField
            app.UpEditField = uieditfield(app.QMUPanel, 'text');
            app.UpEditField.HorizontalAlignment = 'right';
            app.UpEditField.FontSize = 16;
            app.UpEditField.Position = [383 365 100 23];
            app.UpEditField.Value = '0.9999';

            % Create Label_22
            app.Label_22 = uilabel(app.QMUPanel);
            app.Label_22.HorizontalAlignment = 'right';
            app.Label_22.FontSize = 16;
            app.Label_22.Position = [301 124 69 22];
            app.Label_22.Text = '置信水平';

            % Create MCalphaEditField
            app.MCalphaEditField = uieditfield(app.QMUPanel, 'text');
            app.MCalphaEditField.HorizontalAlignment = 'right';
            app.MCalphaEditField.FontSize = 16;
            app.MCalphaEditField.Position = [385 123 100 23];
            app.MCalphaEditField.Value = '0.95';

            % Create X0Label
            app.X0Label = uilabel(app.QMUPanel);
            app.X0Label.HorizontalAlignment = 'right';
            app.X0Label.FontSize = 16;
            app.X0Label.Position = [518 365 105 22];
            app.X0Label.Text = '安全设计值X0';

            % Create X0EditField
            app.X0EditField = uieditfield(app.QMUPanel, 'text');
            app.X0EditField.HorizontalAlignment = 'right';
            app.X0EditField.FontSize = 16;
            app.X0EditField.Position = [638 364 70 23];

            % Create XthEditFieldLabel
            app.XthEditFieldLabel = uilabel(app.QMUPanel);
            app.XthEditFieldLabel.HorizontalAlignment = 'right';
            app.XthEditFieldLabel.FontSize = 16;
            app.XthEditFieldLabel.Position = [527 336 96 23];
            app.XthEditFieldLabel.Text = '临界阈值Xth';

            % Create XthEditField
            app.XthEditField = uieditfield(app.QMUPanel, 'text');
            app.XthEditField.FontSize = 16;
            app.XthEditField.Position = [638 335 70 24];

            % Create MLabel
            app.MLabel = uilabel(app.QMUPanel);
            app.MLabel.HorizontalAlignment = 'right';
            app.MLabel.FontSize = 20;
            app.MLabel.Position = [599 302 25 24];
            app.MLabel.Text = 'M';

            % Create ZJMEditField
            app.ZJMEditField = uieditfield(app.QMUPanel, 'text');
            app.ZJMEditField.FontSize = 16;
            app.ZJMEditField.Position = [639 304 69 22];

            % Create QLabel
            app.QLabel = uilabel(app.QMUPanel);
            app.QLabel.HorizontalAlignment = 'right';
            app.QLabel.FontSize = 20;
            app.QLabel.Position = [597 240 25 24];
            app.QLabel.Text = 'Q';

            % Create ZJQEditField
            app.ZJQEditField = uieditfield(app.QMUPanel, 'text');
            app.ZJQEditField.FontSize = 16;
            app.ZJQEditField.Position = [637 241 73 23];

            % Create UEditFieldLabel
            app.UEditFieldLabel = uilabel(app.QMUPanel);
            app.UEditFieldLabel.HorizontalAlignment = 'right';
            app.UEditFieldLabel.FontSize = 20;
            app.UEditFieldLabel.Position = [598 272 25 24];
            app.UEditFieldLabel.Text = 'U';

            % Create ZJUEditField
            app.ZJUEditField = uieditfield(app.QMUPanel, 'text');
            app.ZJUEditField.FontSize = 16;
            app.ZJUEditField.Position = [638 273 70 23];

            % Create Label_12
            app.Label_12 = uilabel(app.QMUPanel);
            app.Label_12.FontSize = 20;
            app.Label_12.FontColor = [0 0.4471 0.7412];
            app.Label_12.Position = [777 398 85 26];
            app.Label_12.Text = '摩擦试验';

            % Create X0Label_2
            app.X0Label_2 = uilabel(app.QMUPanel);
            app.X0Label_2.HorizontalAlignment = 'right';
            app.X0Label_2.FontSize = 16;
            app.X0Label_2.Position = [748 365 105 22];
            app.X0Label_2.Text = '安全设计值X0';

            % Create MClimEditField
            app.MClimEditField = uieditfield(app.QMUPanel, 'text');
            app.MClimEditField.HorizontalAlignment = 'right';
            app.MClimEditField.FontSize = 16;
            app.MClimEditField.Position = [856 365 69 23];

            % Create XthEditField_2Label
            app.XthEditField_2Label = uilabel(app.QMUPanel);
            app.XthEditField_2Label.HorizontalAlignment = 'right';
            app.XthEditField_2Label.FontSize = 16;
            app.XthEditField_2Label.Position = [750 328 99 36];
            app.XthEditField_2Label.Text = '临界阈值Xth';

            % Create Xth2EditField
            app.Xth2EditField = uieditfield(app.QMUPanel, 'text');
            app.Xth2EditField.FontSize = 16;
            app.Xth2EditField.Position = [856 334 68 24];

            % Create MLabel_2
            app.MLabel_2 = uilabel(app.QMUPanel);
            app.MLabel_2.HorizontalAlignment = 'right';
            app.MLabel_2.FontSize = 20;
            app.MLabel_2.Position = [818 302 25 24];
            app.MLabel_2.Text = 'M';

            % Create MCMEditField
            app.MCMEditField = uieditfield(app.QMUPanel, 'text');
            app.MCMEditField.FontSize = 16;
            app.MCMEditField.Position = [856 303 68 23];

            % Create ULabel_2
            app.ULabel_2 = uilabel(app.QMUPanel);
            app.ULabel_2.HorizontalAlignment = 'right';
            app.ULabel_2.FontSize = 20;
            app.ULabel_2.Position = [814 272 25 24];
            app.ULabel_2.Text = 'U';

            % Create MCUEditField
            app.MCUEditField = uieditfield(app.QMUPanel, 'text');
            app.MCUEditField.FontSize = 16;
            app.MCUEditField.Position = [856 273 68 23];

            % Create QLabel_2
            app.QLabel_2 = uilabel(app.QMUPanel);
            app.QLabel_2.HorizontalAlignment = 'right';
            app.QLabel_2.FontSize = 20;
            app.QLabel_2.Position = [816 241 25 24];
            app.QLabel_2.Text = 'Q';

            % Create MCQEditField
            app.MCQEditField = uieditfield(app.QMUPanel, 'text');
            app.MCQEditField.FontSize = 16;
            app.MCQEditField.Position = [856 242 68 23];

            % Create Label_11
            app.Label_11 = uilabel(app.QMUPanel);
            app.Label_11.FontSize = 20;
            app.Label_11.FontColor = [0 0.4471 0.7412];
            app.Label_11.Position = [550 398 85 26];
            app.Label_11.Text = '撞击试验';

            % Create QMUButton
            app.QMUButton = uibutton(app.QMUPanel, 'push');
            app.QMUButton.ButtonPushedFcn = createCallbackFcn(app, @QMUButtonPushed, true);
            app.QMUButton.BackgroundColor = [1 0.4118 0.1608];
            app.QMUButton.FontSize = 22;
            app.QMUButton.FontColor = [1 1 1];
            app.QMUButton.Position = [549 435 111 37];
            app.QMUButton.Text = 'QMU评估';

            % Create reportButton
            app.reportButton = uibutton(app.QMUPanel, 'push');
            app.reportButton.ButtonPushedFcn = createCallbackFcn(app, @reportButtonPushed, true);
            app.reportButton.BackgroundColor = [1 0.4118 0.1608];
            app.reportButton.FontSize = 22;
            app.reportButton.FontColor = [1 1 1];
            app.reportButton.Position = [1138 9 111 37];
            app.reportButton.Text = '评估结果';

            % Create QLabel_3
            app.QLabel_3 = uilabel(app.QMUPanel);
            app.QLabel_3.HorizontalAlignment = 'right';
            app.QLabel_3.FontSize = 16;
            app.QLabel_3.Position = [994 303 17 23];
            app.QLabel_3.Text = 'Q';

            % Create MixQEditField
            app.MixQEditField = uieditfield(app.QMUPanel, 'text');
            app.MixQEditField.FontSize = 16;
            app.MixQEditField.Position = [1026 303 85 23];

            % Create MLabel_3
            app.MLabel_3 = uilabel(app.QMUPanel);
            app.MLabel_3.HorizontalAlignment = 'right';
            app.MLabel_3.FontSize = 16;
            app.MLabel_3.Position = [982 365 29 23];
            app.MLabel_3.Text = 'M';

            % Create MixMEditField
            app.MixMEditField = uieditfield(app.QMUPanel, 'text');
            app.MixMEditField.FontSize = 16;
            app.MixMEditField.Position = [1026 365 85 23];

            % Create ULabel_3
            app.ULabel_3 = uilabel(app.QMUPanel);
            app.ULabel_3.HorizontalAlignment = 'right';
            app.ULabel_3.FontSize = 16;
            app.ULabel_3.Position = [987 336 24 23];
            app.ULabel_3.Text = 'U';

            % Create MixUEditField
            app.MixUEditField = uieditfield(app.QMUPanel, 'text');
            app.MixUEditField.FontSize = 16;
            app.MixUEditField.Position = [1026 336 85 23];

            % Create QMULabel_5
            app.QMULabel_5 = uilabel(app.QMUPanel);
            app.QMULabel_5.FontSize = 20;
            app.QMULabel_5.FontColor = [0 0.4471 0.7412];
            app.QMULabel_5.Position = [994 398 132 26];
            app.QMULabel_5.Text = '多元QMU评估';

            % Create ZJGauge
            app.ZJGauge = uigauge(app.QMUPanel, 'circular');
            app.ZJGauge.Limits = [0 3];
            app.ZJGauge.ScaleColors = [1 0 0;1 1 0.0667;0.902 0.902 0.902];
            app.ZJGauge.ScaleColorLimits = [0 1;1 1.5;1.5 3];
            app.ZJGauge.Position = [639 24 70 70];

            % Create ZJQLamp
            app.ZJQLamp = uilamp(app.QMUPanel);
            app.ZJQLamp.Position = [731 49 20 20];

            % Create MCGauge
            app.MCGauge = uigauge(app.QMUPanel, 'circular');
            app.MCGauge.Limits = [0 3];
            app.MCGauge.ScaleColors = [1 0 0;1 1 0.0667;0.902 0.902 0.902];
            app.MCGauge.ScaleColorLimits = [0 1;1 1.5;1.5 3];
            app.MCGauge.Position = [855 24 70 70];

            % Create MCQLamp
            app.MCQLamp = uilamp(app.QMUPanel);
            app.MCQLamp.Position = [943 49 20 20];

            % Create Label_23
            app.Label_23 = uilabel(app.QMUPanel);
            app.Label_23.HorizontalAlignment = 'right';
            app.Label_23.Position = [698 435 125 22];
            app.Label_23.Text = '安全性设计值输入方式';

            % Create DropDown
            app.DropDown = uidropdown(app.QMUPanel);
            app.DropDown.Items = {'自动计算', '手动输入'};
            app.DropDown.Position = [838 435 100 22];
            app.DropDown.Value = '自动计算';

            % Create UIAxes
            app.UIAxes = uiaxes(app.QMUPanel);
            title(app.UIAxes, 'QMU综合评估')
            xlabel(app.UIAxes, '撞击')
            ylabel(app.UIAxes, '摩擦')
            app.UIAxes.PlotBoxAspectRatio = [1 1 1];
            app.UIAxes.XTick = [0 1 2 3];
            app.UIAxes.XTickLabel = {'0'; '1'; '2'; '3'};
            app.UIAxes.YTick = [0 1 2 3];
            app.UIAxes.YTickLabel = {'0'; '1'; '2'; '3'};
            app.UIAxes.Position = [1010 57 239 170];

            % Create UIZJAxes
            app.UIZJAxes = uiaxes(app.QMUPanel);
            title(app.UIZJAxes, '撞击QMU结果')
            app.UIZJAxes.XTick = [];
            app.UIZJAxes.YTick = [];
            app.UIZJAxes.Position = [550 74 215 147];

            % Create UIMCAxes
            app.UIMCAxes = uiaxes(app.QMUPanel);
            title(app.UIMCAxes, '摩擦QMU结果')
            app.UIMCAxes.XTick = [];
            app.UIMCAxes.YTick = [];
            app.UIMCAxes.Position = [780 74 215 147];

            % Create Button
            app.Button = uibutton(app.UIFigure, 'push');
            app.Button.ButtonPushedFcn = createCallbackFcn(app, @ButtonPushed, true);
            app.Button.BackgroundColor = [0.502 0.502 0.502];
            app.Button.FontSize = 22;
            app.Button.FontColor = [1 1 1];
            app.Button.Position = [1123 830 71 37];
            app.Button.Text = '退出';

            % Show the figure after all components are created
            app.UIFigure.Visible = 'on';
        end
    end

    % App creation and deletion
    methods (Access = public)

        % Construct app
        function app = QMU_main

            % Create UIFigure and components
            createComponents(app)

            % Register the app with App Designer
            registerApp(app, app.UIFigure)

            if nargout == 0
                clear app
            end
        end

        % Code that executes before app deletion
        function delete(app)

            % Delete UIFigure when app is deleted
            delete(app.UIFigure)
        end
    end
end