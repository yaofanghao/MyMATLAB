xc = [1.89, 2.66, 1.71, 2.16, 1.12, 1.49, 1.90, 2.64, 2.09, 1.85, 1.61, 1.93, 2.88, 2.05,...
    1.96, 1.84, 2.59, 1.48, 1.97, 1.57, 2.01, 1.77, 2.14, 1.32, 1.07, 1.48, 2.57, 1.53,...
    1.66, 1.06, 2.28, 2.61, 2.02, 1.57, 1.79, 2.42, 1.91, 2.38, 0.88, 2.29, 1.77, 1.85,...
    1.41, 2.51, 1.57, 2.34, 2.19, 2.91, 2.25, 2.31];
% x =  [2, 1.5, 2, 1.5, 2, 1.5, 1, 1.5, 2, 2.5, 2, 1.5, 2, 2.5,...
%     2, 1.5, 2, 2.5, 2, 1.5, 2, 2.5, 2, 2.5, 2, 1.5, 1, 1.5,...
%     2, 1.5, 1, 1.5, 2, 2.5, 2, 1.5, 2, 1.5, 2, 1.5, 2, 1.5,...
%     2, 1.5, 2, 1.5, 2, 2.5, 3, 2.5];

% mean(xc)
mean(x)
std(x)

n = 50; %样本量
x = zeros(1,n); %存放xi
x(1) = 2; %设置x1为2
d = 0.5; %设置步长d
y = zeros(1,n); %存放响应值0或1

for i = 1:n
    if x(i) >= xc(i)
        y(i) = 1;
        x(i+1) = x(i)-d;
    else
        y(i) = 0;
        x(i+1) = x(i)+d;
    end
end
x(:,51) = []; %删除生成的x(51)

% 可视化
xzhou = 1:1:n;
subplot(2,1,1); scatter(xzhou,xc); hold on; plot(xzhou,x); 
xlabel('样本数'); ylabel('刺激量'); title('临界刺激量和试验刺激量对比'); axis padded

subplot(2,1,2); plot(xzhou,y) 
xlabel('样本数'); ylabel('响应'); title('响应结果'); ylim([0 1]); axis padded